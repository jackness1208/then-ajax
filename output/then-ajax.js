"use strict";function encodeData(t,e,n){var o,a=[],r=e;return o=n?n+"["+t+"]":t,"object"==typeof e&&null!==e?a=a.concat(setObjData(e,t)):(o=encodeURIComponent(o),r=encodeURIComponent(r),a.push(o+"="+r)),a}function setObjData(n,o){var a=[];return"[object Array]"===Object.prototype.toString.call(n)?n.forEach(function(t,e){a=a.concat(encodeData("object"==typeof t?""+e:"",t,o))}):"[object Object]"===Object.prototype.toString.call(n)&&Object.keys(n).forEach(function(t){var e=n[t];a=a.concat(encodeData(t,e,o))}),a}function setStrData(t){var e=t.split("&");return e.forEach(function(t){var e=t.split("=");encodeURIComponent(e[0]),encodeURIComponent(e[1])}),e}function ajax(t){var e,n,o,a=t.url||"",r=(t.methods||"get").toLowerCase(),s=t.data||null,c=t.contentType||"",u=t.dataType||"",i=void 0===t.async||t.async,p=t.timeout,d=t.before||function(){return null},f=t.error||function(){return null},l=t.success||function(){return null},j=t.jsonp||"callback",m=t.jsonpcb||"",h=!1,x=null,b=null;function y(){void 0!==p&&(x=setTimeout(function(){"jsonp"===u||(h=!0,b&&b.abort())},p))}s&&("string"==typeof s?s=setStrData(s):"object"==typeof s&&(s=setObjData(s)),s=s.join("&").replace("/%20/g","+"),"get"!==r&&"jsonp"!==u||(a+=-1<a.indexOf("?")?-1<a.indexOf("=")?"&"+s:s:"?"+s)),d(),"jsonp"===u?(n=document.createElement("script"),o="JSONP_"+((new Date).getTime()+Math.round(1e3*Math.random())),m&&(o=m),window[o]=function(t){clearTimeout(x),document.body.removeChild(n),l(t)},n.src=a+(-1<a.indexOf("?")?"&":"?")+j+"="+o,n.type="text/javascript",document.body.appendChild(n)):((b=window.XMLHttpRequest?new XMLHttpRequest:(["Microsoft","msxm3","msxml2","msxml1"].forEach(function(t){try{e=new ActiveXObject(t+".XMLHTTP")}catch(t){}}),e)).open(r,a,i),"post"!==r||c?c&&b.setRequestHeader("Content-Type",c):b.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),b.onreadystatechange=function(){if(4===b.readyState){if(void 0!==p){if(h)return;clearTimeout(x)}200<=b.status&&b.status<300||304===b.status?l("json"===u?JSON.parse(b.responseText):b.responseText):f(b.status,b.statusText)}},b.send("get"===r?null:s)),y()}function thenAjax(t){return new Promise(function(e,n){var o,a=!1;t.timeout&&(o=setTimeout(function(){a=!0,n(new Error("timeout"))},t.timeout)),ajax(Object.assign(t,{success:function(t){a||(clearTimeout(o),e(t))},error:function(t){n(t)}}))})}function thenGet(t,e,n){return thenAjax(Object.assign({data:e,dataType:"json",methods:"get",url:t},n))}function thenPost(t,e,n){return thenAjax(Object.assign({data:e,dataType:"json",methods:"post",url:t},n))}function thenJsonp(t,e,n){return thenAjax(Object.assign({data:e,dataType:"jsonp",methods:"get",url:t},n))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ajax=ajax,exports.thenAjax=thenAjax,exports.thenGet=thenGet,exports.thenJsonp=thenJsonp,exports.thenPost=thenPost;
